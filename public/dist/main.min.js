!function(){function t(t,e,r){e.state("home",{url:"/",templateUrl:"./scripts/home/home.tpl.html"}).state("login",{url:"/signin",templateUrl:"./scripts/login/login.tpl.html",controller:"LoginPageController",controllerAs:"vm"}).state("registration",{url:"/registation",templateUrl:"./scripts/registration/registration.tpl.html",controller:"RegistrationPageController",controllerAs:"vm"}).state("main",{url:"","abstract":!0,templateUrl:"./scripts/main/main.tpl.html",controller:"MainPageController",controllerAs:"vm"}).state("main.lists",{url:"/:username",templateUrl:"./scripts/main/lists/lists.tpl.html",controller:"ListsPageController",controllerAs:"vm"}).state("main.profile",{url:"/profile",templateUrl:"./scripts/main/profile/profile.tpl.html",controller:"ProfilePageController",controllerAs:"vm"}).state("notfound",{url:"/404",templateUrl:"./scripts/404/404.tpl.html"}),r.otherwise("/404"),t.html5Mode(!0)}function e(t,e,r){t.$on("$stateChangeSuccess",function(t,e){var r=e.name.split(".");document.body.className=r[r.length-1]+"-page"})}angular.module("trelloProject",["ui.router","ngResource","ui.tree","ngScrollable"]).config(t).run(e),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"],e.$inject=["$rootScope","$state","$window"]}(),function(){"use strict";function t(t,e,r){function o(o){if(i.submitted=!0,o){var n={email:i.email,password:i.password};r.login({},n,function(r){t.localStorage.token=r.token,t.localStorage.user=r.user,e.go("main.lists",{username:r.user})},function(e){delete t.localStorage.token,i.message=e.data.message})}}function n(){i.message=null}var i=this;i.login=o,i.clearMessageError=n}angular.module("trelloProject").controller("LoginPageController",t),t.$inject=["$window","$state","AuthService"]}(),function(){"use strict";function t(){function t(){e.showDropdown=!1}var e=this;e.showDropdown=!1,e.closeDropdown=t}angular.module("trelloProject").controller("MainPageController",t)}(),function(){"use strict";function t(t,e,r){function o(o){if(i.submitted=!0,o){var n={username:i.name,email:i.email,password:i.password};r.save({},n,function(r){t.localStorage.token=r.token,t.localStorage.user=i.name,e.go("main.lists",{username:i.name})},function(e){delete t.localStorage.token,i.message=e.data.message})}}function n(){i.message&&(i.message=null)}var i=this;i.registration=o,i.clearMessageError=n}angular.module("trelloProject").controller("RegistrationPageController",t),t.$inject=["$window","$state","AuthService"]}(),function(){"use strict";function t(t){t.interceptors.push("AuthInterceptor")}function e(t,e,r,o){return{request:function(t){return t.headers=t.headers||{},r.localStorage.token&&(t.headers.Authorization="Bearer "+r.localStorage.token),t},responseError:function(t){return 401===t.status?o.get("$state").go("home"):404===t.status&&o.get("$state").go("notfound"),e.reject(t)}}}angular.module("trelloProject").factory("AuthInterceptor",e).config(t),t.$inject=["$httpProvider"],e.$inject=["$rootScope","$q","$window","$injector"]}(),function(){"use strict";function t(t){return t("/auth/:type",{type:"@type"},{save:{method:"POST",params:{type:"signup"}},login:{method:"POST",params:{type:"login"}}})}angular.module("trelloProject").factory("AuthService",t),t.$inject=["$resource"]}(),function(){"use strict";function t(t){var e=t("/api/user/:user/lists/:list/cards/:card",{user:"@user",list:"@list",card:"@card"},{query:{method:"GET",isArray:!1},update:{method:"PUT"}});return e}angular.module("trelloProject").factory("CardService",t),t.$inject=["$resource"]}(),function(){"use strict";function t(t){var e=t("/api/user/:user/lists/:id",{user:"@user",id:"@id"},{query:{method:"GET",isArray:!1},update:{method:"PUT"}});return e}angular.module("trelloProject").factory("ListService",t),t.$inject=["$resource"]}(),function(){"use strict";function t(t,e,r){function o(){r.get({user:c},function(t){a.lists=t.lists,s()})}function n(){a.newListTitle&&r.save({user:c},{title:a.newListTitle},function(t){a.lists=t.lists,a.focusOn=!0,a.newListTitle=null,s()})}function i(){a.visibleNewList=!0,a.focusOn=!0}function l(){o()}function s(){var e=290*(a.lists.length+1);document.querySelector(".lists__wrapper").style.width=e+"px",t.$broadcast("content.changed")}var a=this,c=e.username;a.visibleNewList=!1,a.createNewList=n,a.setVisibleNewList=i,a.reloadLists=l,o(),t.listOptions={accept:function(t,e,r){var o=t.$element.hasClass("list__wrapper"),n=e.$element.hasClass("list__placeholder"),i=t.$element.hasClass("list__card"),l=e.$element.hasClass("card__placeholder");return o===n?!0:i===l?!0:void 0}}}angular.module("trelloProject").controller("ListsPageController",t),t.$inject=["$scope","$stateParams","ListService"]}(),function(){"use strict";function t(t){var e=this;t.get(function(t){e.username=t.name,e.email=t.email,e.avatar=t.avatar})}angular.module("trelloProject").controller("ProfilePageController",t),t.$inject=["ListService"]}(),function(){"use strict";function t(){var t={require:"^list",restrict:"E",replace:!0,scope:{data:"="},templateUrl:"./scripts/common/directives/card/card.tpl.html",controller:e,controllerAs:"vm",bindToController:!0};return t}function e(){}angular.module("trelloProject").directive("card",t)}(),function(){"use strict";function t(t,e){function r(r,o,n){var i=e(n.clickOutside),l=function(t){var e=o[0].contains(t.target);if(t&&t.target&&!e)return r.$apply(function(){return i(r)})};t.on("click",l),r.$on("$destroy",function(){t.off("click",l)})}var o={restrict:"A",link:r};return o}angular.module("trelloProject").directive("clickOutside",t),t.$inject=["$document","$parse"]}(),function(){"use strict";function t(t){function e(e,r,o){e.$watch("trigger",function(o){o&&t(function(){r[0].focus(),e.trigger=!1})})}var r={restrict:"A",scope:{trigger:"=customFocus"},link:e};return r}angular.module("trelloProject").directive("customFocus",t),t.$inject=["$timeout"]}(),function(){"use strict";function t(){var t={restrict:"E",replace:!0,scope:{data:"=",reload:"&"},templateUrl:"./scripts/common/directives/list/list.tpl.html",controller:e,controllerAs:"vm",bindToController:!0};return t}function e(t,e,r){function o(){s.showDropdown=!1}function n(){s.visibleNewCard=!0,s.focusOn=!0}function i(){e["delete"]({user:a,id:c},function(t){s.reload()})}function l(){if(s.newCardsText){({text:s.newCardsText});r.save({user:a,list:c},{text:s.newCardsText},function(t){s.data.cards=t.cards,s.focusOn=!0,s.newCardsText=null})}}var s=this,a=t.username,c=s.data._id;s.visibleNewCard=!1,s.closeDropdown=o,s.createNewCard=l,s.showNewCardInput=n,s.removeList=i}angular.module("trelloProject").directive("list",t),e.$inject=["$stateParams","ListService","CardService"]}(),function(){"use strict";function t(t){function e(e,r,o){e.$last===!0&&t(function(){e.$emit("ngRepeatFinished")})}var r={restrict:"A",link:e};return r}angular.module("trelloProject").directive("onFinishRender",t),t.$inject=["$timeout"]}();
//# sourceMappingURL=main.min.js.map
